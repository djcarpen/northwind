<workflow-app xmlns="uri:oozie:workflow:0.4" name="edl-northwind-loaddv-workflow">

	<credentials>
		<credential name="hs2_credentials" type="hive2">
			<property>
				<name>hive2.server.principal</name>
				<value>${jdbcPrincipal}</value>
			</property>
			<property>
				<name>hive2.jdbc.url</name>
				<value>${jdbcURL}</value>
			</property>
		</credential>
	</credentials>

	<start to="edl-northwind-loaddv-insert-customers"/>

	<action name="edl-northwind-loaddv-insert-customers">
		<sub-workflow>
			<app-path>${codeBaseDir}/workflow/edl-northwind-loaddv-insert-customers-workflow.xml</app-path>
			<propagate-configuration/>
			<configuration>
				<property>
					<name>tez.queue.name</name>
					<value>${queueName}</value>
				</property>
				<property>
					<name>oozie.hive.log.level</name>
					<value>DEBUG</value>
				</property>
				<property>
					<name>oozie.action.external.stats.write</name>
					<value>true</value>
				</property>
			</configuration>
		</sub-workflow>
		<ok to="end"/>
		<error to="kill-edl-northwind-loaddv-customer-insert"/>
	</action>

	<kill name="kill-edl-northwind-loaddv-customer-insert">
		<message>Action failed executing inserts into ${dataVaultType} customers, error message[${wf:errorMessage(wf:lastErrorNode())}]</message>
	</kill>

	<kill name="kill">
		<message>Action failed, error message[${wf:errorMessage(wf:lastErrorNode())}]</message>
	</kill>

	<end name="end"/>

</workflow-app>